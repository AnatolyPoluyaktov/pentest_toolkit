import csv
import io
import os
import threading
from datetime import timedelta
from functools import reduce
from operator import and_, or_

import requests
import validators
from django import http
from django.conf import settings
from django.contrib import messages
from django.db.models import Count, Q
from django.shortcuts import get_object_or_404, render
from django.urls import reverse
from django.utils import timezone
from django.utils.safestring import mark_safe

from core.common_func import *
from core.scanEngine.forms import *
from core.scanEngine.models import *
from core.startScan.models import *
from core.targetApp.forms import *
from core.targetApp.forms.add_project import AddProjectForm
from core.targetApp.forms.add_target import AddTargetForm
from core.targetApp.forms.update_project import UpdateProjectForm
from core.targetApp.forms.update_target import UpdateTargetForm
from core.targetApp.models import *


def delete_targets(request):
    context = {}
    if request.method == "POST":
        list_of_domains = []
        for key, value in request.POST.items():
            if key != "list_target_table_length" and key != "csrfmiddlewaretoken":
                Domain.objects.filter(id=value).delete()
        messages.add_message(request, messages.INFO, "Targets deleted!")
    return http.HttpResponseRedirect(reverse("list_target"))
