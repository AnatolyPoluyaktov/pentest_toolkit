from django import forms

from core.targetApp.models import Domain, Project
from core.validators import validate_domain


class UpdateProjectForm(forms.ModelForm):
    def __init__(self, *args, **kwargs):
        super(UpdateProjectForm, self).__init__(*args, **kwargs)
        self.fields["domains"].choices = [
            (domain.id, domain.name) for domain in Domain.objects.all()
        ]

    class Meta:
        model = Project
        fields = ["name", "description", "domains"]

    name = forms.CharField(
        required=True,
        widget=forms.TextInput(
            attrs={
                "class": "form-control",
                "id": "projectName",
            }
        ),
    )

    description = forms.CharField(
        required=False,
        widget=forms.TextInput(
            attrs={
                "class": "form-control",
                "id": "projectDescription",
            }
        ),
    )

    domains = forms.ChoiceField(
        required=True,
        widget=forms.Select(
            attrs={
                "class": "form-control form-control-lg tagging",
                "multiple": "multiple",
                "id": "domains",
            }
        ),
    )

    def set_value(self, project_value, description_value):
        self.initial["name"] = project_value
        self.initial["description"] = description_value
