from django.db import models

from core.startScan.models import CountryISO


class IpAddress(models.Model):
    id = models.AutoField(primary_key=True)
    address = models.CharField(max_length=100, blank=True, null=True)
    is_cdn = models.BooleanField(default=False)
    ports = models.ManyToManyField("Port", related_name="ports")
    geo_iso = models.ForeignKey(
        CountryISO, on_delete=models.CASCADE, null=True, blank=True
    )
    # this is used for querying which ip was discovered during subcan
    ip_subscan_ids = models.ManyToManyField("SubScan", related_name="ip_subscan_ids")

    def __str__(self):
        return str(self.address)
