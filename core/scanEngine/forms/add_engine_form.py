from django import forms
from django_ace import AceWidget

from core.scanEngine.models import *
from core.validators import validate_short_name


class AddEngineForm(forms.ModelForm):
    class Meta:
        model = EngineType
        fields = "__all__"

    engine_name = forms.CharField(
        required=True,
        widget=forms.TextInput(
            attrs={
                "class": "form-control form-control-lg",
                "id": "scan_engine_name",
                "placeholder": "Engine Name",
            }
        ),
    )
    subdomain_discovery = forms.BooleanField(
        required=False,
        widget=forms.CheckboxInput(
            attrs={
                "checked": "",
                "class": "switch",
            }
        ),
    )
    waf_detection = forms.BooleanField(
        required=False,
        widget=forms.CheckboxInput(
            attrs={
                "class": "switch",
            }
        ),
    )
    screenshot = forms.BooleanField(
        required=False,
        widget=forms.CheckboxInput(
            attrs={
                "checked": "",
                "class": "switch",
            }
        ),
    )
    dir_file_fuzz = forms.BooleanField(
        required=False,
        widget=forms.CheckboxInput(
            attrs={
                "class": "switch",
            }
        ),
    )
    port_scan = forms.BooleanField(
        required=False,
        widget=forms.CheckboxInput(
            attrs={
                "class": "switch",
            }
        ),
    )
    fetch_url = forms.BooleanField(
        required=False,
        widget=forms.CheckboxInput(
            attrs={
                "class": "switch",
            }
        ),
    )
    vulnerability_scan = forms.BooleanField(
        required=False,
        widget=forms.CheckboxInput(
            attrs={
                "checked": "",
                "class": "switch",
            }
        ),
    )
    osint = forms.BooleanField(
        required=False,
        widget=forms.CheckboxInput(
            attrs={
                "class": "switch",
            }
        ),
    )
    yaml_configuration = forms.CharField(
        widget=AceWidget(
            mode="yaml",
            theme="tomorrow_night_eighties",
            width="100%",
            height="450px",
            tabsize=2,
            fontsize="17px",
            showinvisibles=True,
            attrs={"id": "editor"},
        )
    )
