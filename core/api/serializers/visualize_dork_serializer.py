from django.db.models import F, JSONField, Value
from rest_framework import serializers

from core.common_func import *
from core.dashboard.models import *
from core.recon_note.models import *
from core.scanEngine.models import *
from core.startScan.models import *
from core.targetApp.models import Domain, Project


class VisualiseDorkSerializer(serializers.ModelSerializer):

    title = serializers.SerializerMethodField("get_title")
    description = serializers.SerializerMethodField("get_description")
    http_url = serializers.SerializerMethodField("get_http_url")

    class Meta:
        model = Dork
        fields = ["title", "description", "http_url"]

    def get_title(self, dork):
        return dork.type

    def get_description(self, dork):
        return dork.description

    def get_http_url(self, dork):
        return dork.url
