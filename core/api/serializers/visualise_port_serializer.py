from django.db.models import F, JSONField, Value
from rest_framework import serializers

from core.common_func import *
from core.dashboard.models import *
from core.recon_note.models import *
from core.scanEngine.models import *
from core.startScan.models import *
from core.targetApp.models import Domain, Project


class VisualisePortSerializer(serializers.ModelSerializer):

    description = serializers.SerializerMethodField("get_description")
    title = serializers.SerializerMethodField("get_title")

    class Meta:
        model = Port
        fields = [
            "description",
            "is_uncommon",
            "title",
        ]

    def get_description(self, port):
        return str(port.number) + "/" + str(port.service_name)

    def get_title(self, port):
        if port.is_uncommon:
            return "Uncommon Port"
