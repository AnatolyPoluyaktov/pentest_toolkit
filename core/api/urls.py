from django.conf.urls import include, url
from django.urls import path
from rest_framework import routers

from .views.add_recon_note import AddReconNote
from .views.add_target import AddTarget
from .views.cms_detector import CMSDetector
from .views.cve_details import CVEDetails
from .views.delete_multiple_rows import DeleteMultipleRows
from .views.delete_subdomain import DeleteSubdomain
from .views.directory_viewset import DirectoryViewSet
from .views.endpoint_changes_viewset import EndPointChangesViewSet
from .views.endpoint_viewset import EndPointViewSet
from .views.fetch_common_vulnerability import FetchMostCommonVulnerability
from .views.fetch_most_vulnerable import FetchMostVulnerable
from .views.fetch_sub_scan_results import FetchSubscanResults
from .views.get_external_tool_current_version import \
    GetExternalToolCurrentVersion
from .views.get_file_contents import GetFileContents
from .views.initiate_subtask import InitiateSubTask
from .views.interesting_endpoint_viewset import InterestingEndpointViewSet
from .views.interesting_subdomain_viewset import InterestingSubdomainViewSet
from .views.ip_address_viewset import IpAddressViewSet
from .views.ip_to_domain import IPToDomain
from .views.list_dork_types import ListDorkTypes
from .views.list_dorks import ListDorks
from .views.list_emails import ListEmails
from .views.list_employess import ListEmployees
from .views.list_endpoints import ListEndpoints
from .views.list_engines import ListEngines
from .views.list_interesting_keywords import ListInterestingKeywords
from .views.list_ips import ListIPs
from .views.list_meta_data import ListMetadata
from .views.list_osint_users import ListOsintUsers
from .views.list_ports import ListPorts
from .views.list_projects import Listprojects
from .views.list_scan_history import ListScanHistory
from .views.list_subdomains import ListSubdomains
from .views.list_subscans import ListSubScans
from .views.list_targets_in_projects import ListTargetsInproject
from .views.list_targets_without_project import ListTargetsWithoutproject
from .views.list_technology import ListTechnology
from .views.list_todo_notes import ListTodoNotes
from .views.scan_status import ScanStatus
from .views.search_history import SearchHistoryView
from .views.stop_scan import StopScan
from .views.subdomain_changes_viewset import SubdomainChangesViewSet
from .views.subdomain_datatable_viewset import SubdomainDatatableViewSet
from .views.subdomain_viewset import SubdomainsViewSet
from .views.toggle_subdomain_important_status import \
    ToggleSubdomainImportantStatus
from .views.uninstall_tool import UninstallTool
from .views.universal_search import UniversalSearch
from .views.visualise_data import VisualiseData
from .views.vulnerability_viewset import VulnerabilityViewSet
from .views.waf_detector import WafDetector
from .views.whois import Whois

app_name = "api"
router = routers.DefaultRouter()

router.register(r"listDatatableSubdomain", SubdomainDatatableViewSet)

router.register(r"listSubdomains", SubdomainsViewSet)

router.register(r"listEndpoints", EndPointViewSet)

router.register(r"listDirectories", DirectoryViewSet)

router.register(r"listVulnerability", VulnerabilityViewSet)

router.register(r"listInterestingSubdomains", InterestingSubdomainViewSet)

router.register(r"listInterestingEndpoints", InterestingEndpointViewSet)

router.register(r"listSubdomainChanges", SubdomainChangesViewSet)

router.register(r"listEndPointChanges", EndPointChangesViewSet)

router.register(r"listIps", IpAddressViewSet)

urlpatterns = [
    url("^", include(router.urls)),
    path("add/target/", AddTarget.as_view(), name="addTarget"),
    path("add/recon_note/", AddReconNote.as_view(), name="addReconNote"),
    path("queryTechnologies/", ListTechnology.as_view(), name="listTechnologies"),
    path("queryPorts/", ListPorts.as_view(), name="listPorts"),
    path("queryIps/", ListIPs.as_view(), name="listIPs"),
    path("querySubdomains/", ListSubdomains.as_view(), name="querySubdomains"),
    path("queryEndpoints/", ListEndpoints.as_view(), name="queryEndpoints"),
    path("queryOsintUsers/", ListOsintUsers.as_view(), name="queryOsintUsers"),
    path("queryMetadata/", ListMetadata.as_view(), name="queryMetadata"),
    path("queryEmails/", ListEmails.as_view(), name="queryEmails"),
    path("queryEmployees/", ListEmployees.as_view(), name="queryEmployees"),
    path("queryDorks/", ListDorks.as_view(), name="queryDorks"),
    path("queryDorkTypes/", ListDorkTypes.as_view(), name="queryDorkTypes"),
    path(
        "queryAllScanResultVisualise/",
        VisualiseData.as_view(),
        name="queryAllScanResultVisualise",
    ),
    path(
        "queryTargetsWithoutproject/",
        ListTargetsWithoutproject.as_view(),
        name="queryTargetsWithoutproject",
    ),
    path(
        "queryTargetsInproject/",
        ListTargetsInproject.as_view(),
        name="queryTargetsInproject",
    ),
    path("listprojects/", Listprojects.as_view(), name="listprojects"),
    path("listEngines/", ListEngines.as_view(), name="listEngines"),
    path("listSubScans/", ListSubScans.as_view(), name="listSubScans"),
    path("listScanHistory/", ListScanHistory.as_view(), name="listScanHistory"),
    path("listTodoNotes/", ListTodoNotes.as_view(), name="listTodoNotes"),
    path(
        "listInterestingKeywords/",
        ListInterestingKeywords.as_view(),
        name="listInterestingKeywords",
    ),
    path("getFileContents/", GetFileContents.as_view(), name="getFileContents"),
    path("tools/ip_to_domain/", IPToDomain.as_view(), name="ip_to_domain"),
    path("tools/whois/", Whois.as_view(), name="whois"),
    path("tools/cms_detector/", CMSDetector.as_view(), name="cms_detector"),
    path("tools/cve_details/", CVEDetails.as_view(), name="cve_details"),
    path("tools/waf_detector/", WafDetector.as_view(), name="waf_detector"),
    path(
        "external/tool/get_current_release/",
        GetExternalToolCurrentVersion.as_view(),
        name="external_tool_get_current_release",
    ),
    path("tool/uninstall/", UninstallTool.as_view(), name="uninstall_tool"),
    path(
        "action/subdomain/delete/", DeleteSubdomain.as_view(), name="delete_subdomain"
    ),
    path("action/rows/delete/", DeleteMultipleRows.as_view(), name="delete_rows"),
    path(
        "toggle/subdomain/important/",
        ToggleSubdomainImportantStatus.as_view(),
        name="toggle_subdomain",
    ),
    path(
        "action/initiate/subtask/", InitiateSubTask.as_view(), name="initiate_subtask"
    ),
    path("action/stop/scan/", StopScan.as_view(), name="stop_scan"),
    path(
        "fetch/results/subscan/",
        FetchSubscanResults.as_view(),
        name="fetch_subscan_results",
    ),
    path(
        "fetch/most_vulnerable/",
        FetchMostVulnerable.as_view(),
        name="fetch_most_vulnerable",
    ),
    path(
        "fetch/most_common_vulnerability/",
        FetchMostCommonVulnerability.as_view(),
        name="fetch_most_common_vulnerability",
    ),
    path("search/", UniversalSearch.as_view(), name="search"),
    path("search/history/", SearchHistoryView.as_view(), name="search_history"),
    # API for fetching currently ongoing scans and upcoming scans
    path("scan_status/", ScanStatus.as_view(), name="scan_status"),
]

urlpatterns += router.urls
